diff -Naur openssh-5.3p1-old/channels.c openssh-5.3p1-new/channels.c
--- openssh-5.3p1-old/channels.c	2009-08-27 18:02:37.000000000 -0700
+++ openssh-5.3p1-new/channels.c	2009-10-01 07:18:56.000000000 -0700
@@ -60,6 +60,7 @@
 #include <termios.h>
 #include <unistd.h>
 #include <stdarg.h>
+#include <stddef.h>
 
 #include "openbsd-compat/sys-queue.h"
 #include "xmalloc.h"
@@ -3172,6 +3173,8 @@
 {
 	int sock;
 	struct sockaddr_un addr;
+	int abstract = 0;
+	int addrsize = 0;
 
 	sock = socket(AF_UNIX, SOCK_STREAM, 0);
 	if (sock < 0)
@@ -3179,8 +3182,15 @@
 	memset(&addr, 0, sizeof(addr));
 	addr.sun_family = AF_UNIX;
 	strlcpy(addr.sun_path, pathname, sizeof addr.sun_path);
-	if (connect(sock, (struct sockaddr *)&addr, sizeof(addr)) == 0)
+	addrsize = offsetof(struct sockaddr_un, sun_path) + strlen(addr.sun_path);
+	if (addr.sun_path[0] = '@')
+		abstract = 1;
+	if (abstract)
+		addr.sun_path[0] = '\0';
+	if (connect(sock, (struct sockaddr *)&addr, addrsize) == 0)
 		return sock;
+	if (abstract)
+		addr.sun_path[0] = '@';
 	close(sock);
 	error("connect %.100s: %.100s", addr.sun_path, strerror(errno));
 	return -1;
diff -Naur openssh-5.3p1-old/defines.h openssh-5.3p1-new/defines.h
--- openssh-5.3p1-old/defines.h	2009-08-27 18:21:07.000000000 -0700
+++ openssh-5.3p1-new/defines.h	2009-10-01 07:18:56.000000000 -0700
@@ -370,7 +370,7 @@
 #  ifdef __hpux
 #    define X_UNIX_PATH "/var/spool/sockets/X11/%u"
 #  else
-#    define X_UNIX_PATH "/tmp/.X11-unix/X%u"
+#    define X_UNIX_PATH "@/tmp/.X11-unix/X%u"
 #  endif
 #endif /* X_UNIX_PATH */
 #define _PATH_UNIX_X X_UNIX_PATH
